# Mattermost - Yandex Calendar –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

![header](imgs/header.PNG)

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ó–∞–¥–∞—á–∞](#–∑–∞–¥–∞—á–∞)
- [–ü—Ä–æ–±–ª–µ–º–∞](#–ø—Ä–æ–±–ª–µ–º–∞)
- [–†–µ—à–µ–Ω–∏–µ](#—Ä–µ—à–µ–Ω–∏–µ)
- [–û–ø–∏—Å–∞–Ω–∏–µ](#–æ–ø–∏—Å–∞–Ω–∏–µ)
- [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–î–µ—Ä–µ–≤–æ –∫–æ–º–∞–Ω–¥](#–¥–µ—Ä–µ–≤–æ-–∫–æ–º–∞–Ω–¥)
- [–ö–æ–º–∞–Ω–¥—ã](#–∫–æ–º–∞–Ω–¥—ã)
- [–ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω](#–ø–æ–ª—É—á–∏—Ç—å-—Ç–æ–∫–µ–Ω)
- [–ó–∞–ø—É—Å–∫](#–∑–∞–ø—É—Å–∫)
- [–¢–µ—Å—Ç—ã](#—Ç–µ—Å—Ç—ã)
- [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–≤-–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π-—Å—Ä–µ–¥–µ)
- [–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç](#–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç)
- [–ê–ª–≥–æ—Ä–∏—Ç–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π](#–∞–ª–≥–æ—Ä–∏—Ç–º-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π)
- [–î–∏–∞–≥—Ä–∞–º–º—ã](#–¥–∏–∞–≥—Ä–∞–º–º—ã)
- [–ü—Ä–æ–±—É–µ–º –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É](#–ø—Ä–æ–±—É–µ–º-–Ω–æ–≤—É—é-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É)
- [–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏](#–ø–æ–ª–µ–∑–Ω—ã–µ-—Å—Å—ã–ª–∫–∏)
- [–í–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç](#–≤–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç)
- [–ü—Ä–æ–±–ª–µ–º—ã –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è](#–ø—Ä–æ–±–ª–µ–º—ã-—è–Ω–¥–µ–∫—Å-–∫–∞–ª–µ–Ω–¥–∞—Ä—è)
- [–ë—É–¥—É—â–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏](#–±—É–¥—É—â–∏–µ-–¥–æ—Ä–∞–±–æ—Ç–∫–∏)
- [–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏](#–±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏)

## –ó–∞–¥–∞—á–∞

> üìù –í –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä–µ –Ω–∞–∑–Ω–∞—á–∞—é—Ç—Å—è –≤—Å—Ç—Ä–µ—á–∏. –ù—É–∂–Ω–æ –∫–∞–∫ –ø–æ —Å—Å—ã–ª–∫–µ
> [YandexCalendar(plugin)](https://github.com/LugaMuga/mattermost-yandex-calendar-plugin) <br>
> - –ü—Ä–∏—Å—ã–ª–∞—Ç—å —É—Ç—Ä–æ–º —Å–ø–∏—Å–æ–∫ –≤—Å—Ç—Ä–µ—á –Ω–∞ –¥–µ–Ω—å.
> - –ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –≤—Å—Ç—Ä–µ—á–∏, –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —è–Ω–¥–µ–∫—Å-—Ç–µ–ª–µ–º–æ—Å—Ç —É –≤—Å—Ç—Ä–µ—á–∏.
> - –°–æ–æ–±—â–∞—Ç—å –æ–± –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á–∞—Ö, –ø–µ—Ä–µ–Ω–æ—Å–∞—Ö –≤—Å—Ç—Ä–µ—á, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á–∞—Ö.
> - –°–æ–æ–±—â–∞—Ç—å –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤—Å—Ç—Ä–µ—á —Å–æ –º–Ω–æ–π (–Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –≤—Å—Ç—Ä–µ—á—É, –æ—Ç–∫–∞–∑–∞–ª–∏—Å—å –æ—Ç –≤—Å—Ç—Ä–µ—á–∏ –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ).
> - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç—É—Å `üìÜ –ù–∞ –≤—Å—Ç—Ä–µ—á–µ`, –∫–æ–≥–¥–∞ –Ω–∞ –≤—Å—Ç—Ä–µ—á–µ.

## –ü—Ä–æ–±–ª–µ–º–∞

> –ü–ª–∞–≥–∏–Ω [YandexCalendar(plugin)](https://github.com/LugaMuga/mattermost-yandex-calendar-plugin) –º–µ—Å—Ç–∞–º–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

## –†–µ—à–µ–Ω–∏–µ

- –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞–≥–∏–Ω–∞ (Go) https://github.com/LugaMuga/mattermost-yandex-calendar-plugin –Ω–∞ Python
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫

## –û–ø–∏—Å–∞–Ω–∏–µ

- [x] –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –≤–∏–¥–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ mattermost –∏ —è–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É CalDAV,
  –∞ –∏–º–µ–Ω–Ω–æ, ___–≤—ã—Ç—è–≥–∏–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π___ –∏–∑ —Å–µ—Ä–≤–µ—Ä–∞.
- [x]  –î–æ—Å—Ç—É–ø–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–æ–º–µ–∂—É—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–∏.
- [x]  –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ª–æ–≥–∏–Ω—É —è–Ω–¥–µ–∫—Å–∞ –∏ —Ç–æ–∫–µ–Ω—É —è–Ω–¥–µ–∫—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- [x]  –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞.
- [x]  –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ —á–∞—Å–æ–≤–æ–º—É –ø–æ—è—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- [x]  –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –Ω–∞—á–∞–ª–∞.
- [x]  –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ "üìÜ In a meeting" –≤–æ –≤—Ä–µ–º—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏. –ï—Å–ª–∏ –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –¥–ª–∏—Ç–µ–ª—å–Ω–µ–µ –∏–ª–∏ –≤
  —Ä–µ–∂–∏–º–µ `–Ω–µ —Å—Ç–∏—Ä–∞—Ç—å`,
  —Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ–∑–≤—Ä–∞—Ç –≤–∞—à–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ—Å–ª–µ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏. –ù–∞–ø—Ä–º–µ—Ä: üè† "Working from home". Status `Don't clear` ->
  üìÜ `In a meeting`. Status `18:30` -> üè† "Working from home". Status `Don't clear`.
- [x]  –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–∫–∫–∞—É–Ω—Ç–∞.
- [x]  –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.
- [x]  –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–∏—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [x]  –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏/–¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π, –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
- [x]  –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —è–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è–º–∏ –ø–æ –≤—ã–±–æ—Ä—É

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker Engine 24.0.5
- Python 3.12

## –î–µ—Ä–µ–≤–æ –∫–æ–º–∞–Ω–¥

    /yandex_calendar
    .
    ‚îú‚îÄ‚îÄ calendars
    ‚îÇ         ‚îú‚îÄ‚îÄ current
    ‚îÇ         ‚îú‚îÄ‚îÄ from_to
    ‚îÇ         ‚îú‚îÄ‚îÄ get_a_month
    ‚îÇ         ‚îú‚îÄ‚îÄ get_a_week
    ‚îÇ         ‚îî‚îÄ‚îÄ today
    ‚îú‚îÄ‚îÄ checks
    ‚îÇ         ‚îú‚îÄ‚îÄ check_account
    ‚îÇ         ‚îî‚îÄ‚îÄ check_scheduler
    ‚îú‚îÄ‚îÄ connections
    ‚îÇ         ‚îú‚îÄ‚îÄ connect
    ‚îÇ         ‚îú‚îÄ‚îÄ disconnect
    ‚îÇ         ‚îú‚îÄ‚îÄ update
    ‚îÇ         ‚îî‚îÄ‚îÄ profile
    ‚îú‚îÄ‚îÄ info
    ‚îî‚îÄ‚îÄ notifications
        ‚îú‚îÄ‚îÄ create
        ‚îú‚îÄ‚îÄ delete
        ‚îî‚îÄ‚îÄ update

## –ö–æ–º–∞–Ω–¥—ã

* yandex_calendar [root all commands in integration app]
    - connections [module authentication client]
        + connect [*connection* to yandex calendar, need required ***login***, ***token yandex app***,
          ***timezone*** - form command]
        + disconnect [*disconnection* account from integration - execute command]
        + update [*update* ***login***, ***token***, ***timezone*** - form command ]
        + profile [*show* info about me(user  attributes) - execute command]

    - calendars [module Yandex Calendar API for client]
        + get_a_week [get conferences *for the week* by user timezone, execute command]
        + get_a_month [get conferences *for the month* by user timezone, execute command]
        + current [get conferences on *current* day by user timezone, need `dd.mm.YYYY` - form command]
        + from_to [get conferences *from* date `dd.mm.YYYY` *to* date `dd.mm.YYYY` by user timezone,
          need start date and end date in format `dd.mm.YYYY` - form command]
        + today [get conferences for *today* by user timezone, execute command]

    - notifications [module scheduler with notifications]
        + create [create jobs with notifications every day or/and every next conference before in 10 minutes,
          need select calendar with exists conferences, select time 00:00->23:45 with interval 15 minutes(required),
          click `Notification` for every next conferences notifications(optional), click `Status` for change status
          when in a meeting]
        + update [clear user jobs(scheduler) and create all by command `create` again]
        + delete [clear user jobs(scheduler)]

    - checks [module checking info about active user]
        + check_account [*check exist user* in integration]
        + check_scheduler [*check exist notifications* for user in integration ]

    - info [help information about commands app, execute command]

## –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç [–Ø–Ω–¥–µ–∫—Å ID](https://id.yandex.ru/)
2. –í–æ–π—Ç–∏ –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
3. –ü–µ—Ä–µ–π—Ç–∏ –≤ `–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å`
4. –í —Å–∞–º–æ–º –Ω–∏–∑—É `–ü–∞—Ä–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π`
5. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ `–ö–∞–ª–µ–Ω–¥–∞—Ä—å CalDAV` –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å
6. –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ª–æ–≥–∏–Ω —è–Ω–¥–µ–∫—Å –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ –ø–∞—Ä–æ–ª—å

–ò–ª–∏ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –ø–µ—Ä–≤—ã–π —à–∞–≥ –∏–∑ https://yandex.ru/support/calendar/common/sync/sync-desktop.html

## –ó–∞–ø—É—Å–∫

- –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    ```shell
    git clone https://github.com/ArtemIsmagilov/mm-yc-notify && cd mm-yc-notify/
    ```
- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
    ```shell
    python3 -m venv venv && source venv/bin/activate
    ```
- –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–∏—Ö –æ–±—â–∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
    ```shell
    cp .example.env .env
    ```
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `wsgi/settings.py`

- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `gunicorn.conf.py`

- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º `microservice/docker-compose.yml`

- –ó–∞–ø—É—Å–∫–∞–µ–º –¥–æ–∫–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä mattermost
    ```bash
    cd ./mm/
    sudo docker compose up
    ```

- –ó–∞–ø—É—Å–∫–∞–µ–º –¥–æ–∫–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ```bash
    —Åd ../microservice
    sudo docker compose up
    ```

- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–æ—Ç–∞ –≤ mattermost, –∞ –∏–º–µ–Ω–Ω–æ - –ø–∏—à–µ–º –∫–æ–º–∞–Ω–¥—É –≤ –ª—é–±–æ–º –¥–∏–∞–ª–æ–≥–æ–≤–æ–º –æ–∫–Ω–µ
    ```
    /app install http http://192.168.31.57:8065/manifest.json
    ```

- –¢–µ–ø–µ—Ä—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞ –≤ –∫–æ–º–∞–Ω–¥—É
  https://www.ibm.com/docs/en/z-chatops/latest?topic=platform-inviting-created-bot-your-mattermost-team

- –°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞

- –í —Ñ–∞–π–ª–µ `.env` –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `MM_APP_TOKEN=example`

- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ–∫–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    ```bash
    sudo docker compose -f ./microservice/docker-compose.yml down
    sudo docker compose -f ./microservice/docker-compose.yml up
    ```
- –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, —É–¥–æ–±–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ postgres –∏ app
    + postgres
      ```bash
      cd /psql
      sudo docker compose up
      ```

    + app
      ```bash
      cd ../
      flask init-db
      bash run-app.bash
      ```

## –¢–µ—Å—Ç—ã

- –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —É –≤–∞—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω mattermost, psql –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —É –±–æ—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–æ–∫–µ–Ω –∏ –ø—Ä–∞–≤–∞.
- –æ—á–∏—â–∞–µ–º –ë–î –≤ `src/`
  ```bash
  sudo quart init-db -c
  ```
- –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã –≤ –ø–∞–ø–∫–µ `src`
  ```bash
  coverage run -m pytest --cache-clear
  ```
  ```bash
  coverage report -m
  ```
  ```text
    Name                                                Stmts   Miss  Cover   Missing
    ---------------------------------------------------------------------------------
    src/app/__init__.py                                    49      3    94%   36, 40, 44
    src/app/app_handlers.py                                14      0   100%
    src/app/async_wraps/async_wrap_caldav.py               27      3    89%   11, 18-19
    src/app/bots/bot_commands.py                           34      4    88%   11, 32, 49, 54
    src/app/calendars/caldav_api.py                        97     14    86%   66-88, 173
    src/app/calendars/caldav_filters.py                    10      6    40%   6-10, 14, 18
    src/app/calendars/caldav_funcs.py                      15      2    87%   20-22
    src/app/calendars/caldav_searchers.py                  21      5    76%   33-37
    src/app/calendars/calendar_app.py                      15      0   100%
    src/app/calendars/calendar_backgrounds.py              25      8    68%   18-24, 28-29
    src/app/calendars/calendar_views.py                    10      1    90%   11
    src/app/calendars/conference.py                        96     33    66%   47, 76, 85, 91, 95-100, 104-109, 113, 117, 121, 129-134, 138-148, 152, 156-163
    src/app/checks/check_app.py                             9      0   100%
    src/app/checks/check_my_account.py                     13      0   100%
    src/app/checks/check_my_scheduler.py                   14      0   100%
    src/app/connections/connection_app.py                  24      3    88%   20, 25, 35
    src/app/connections/connection_backgrounds.py          40      8    80%   24, 40, 43-50, 65, 86
    src/app/connections/connection_handlers.py             62      7    89%   49-52, 68, 138-141
    src/app/constants.py                                    3      0   100%
    src/app/converters.py                                  79     46    42%   19-20, 30, 34-36, 40-41, 46-48, 55-70, 77-88, 92-97, 101, 111-114, 118, 126, 130
    src/app/decorators/account_decorators.py               65      3    95%   77-79
    src/app/dict_responses.py                              48      7    85%   49, 106, 120, 127, 148, 155, 162
    src/app/notifications/notification_app.py              24      0   100%
    src/app/notifications/notification_backgrounds.py      46      3    93%   44-46, 84
    src/app/notifications/notification_handlers.py         99      4    96%   37, 112, 174, 251
    src/app/notifications/notification_views.py            23      7    70%   20, 37-40, 53-56
    src/app/notifications/tasks.py                        212    102    52%   35-36, 42-43, 49-50, 56-57, 63-64, 100, 116, 135-183, 198, 223-278, 286, 292, 299, 336-435, 441-455
    src/app/notifications/worker.py                        14      0   100%
    src/app/schemas.py                                     30      0   100%
    src/app/sql_app/crud.py                                87      9    90%   149, 173-183, 194, 244, 261-272, 276
    src/app/sql_app/database.py                             8      0   100%
    src/app/sql_app/db_CLI.py                              21     10    52%   15-20, 24-25, 29-31
    src/app/sql_app/models.py                               5      0   100%
    src/app/validators.py                                   8      2    75%   8-9
    src/settings.py                                        35      0   100%
    src/tests/__init__.py                                   0      0   100%
    src/tests/additional_funcs.py                          33      2    94%   67-68
    src/tests/conftest.py                                  51      4    92%   28, 50, 54, 81
    src/tests/test_app.py                                 633      2    99%   1226-1227
    ---------------------------------------------------------------------------------
    TOTAL                                                2099    298    86%
  ```
  –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ html
  ```bash
  coverage html
  ```
  –ü–æ–º–∏–º–æ —Ç–µ—Å—Ç–æ–≤ —Ç–∞–∫–∂–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–±–ª—é–¥–µ–Ω–∏–µ PEP8
  ```bash
  flake8 src/
  ```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ

- –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ https://certbot.eff.org/
- —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –¥–æ–∫–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–∞—Ç—Ç–µ—Ä–º–æ—Å—Ç–∞ —Å HTTPS https://docs.mattermost.com/install/install-docker.html
- –≤ `wsgi/gunicorn.conf.py` –º–µ–Ω—è–µ–º –ø—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ https, —Ö–æ—Å—Ç –∏ –ø–æ—Ä—Ç –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–µ `127.0.0.1:5000 `, –¥–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
  –∏ —É–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Ç–∏ –∫ –Ω–∏–º. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –∏ –ø–æ—Ç–æ–∫–æ–≤. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç
  –≤–∞—à–µ–π –∫–æ—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –º–µ–Ω—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env`
- –¥–æ–±–∞–≤–ª—è–µ–º nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ö–æ—Å—Ç –∏ –ø–æ—Ä—Ç
  ```bash
  sudo nano /etc/nginx/sites-enabled/app_nginx
  ```
  ```
  # in /etc/nginx/sites-enabled
  # reverse proxy app
  # http
    
  #server {
  #    listen 10081;
  #    listen [::]:10081;
  #    location / {
  #        include proxy_params;
  #        proxy_pass http://127.0.0.1:5000/;
  #    }
  #}
    
  # https
  server {
      listen 10441 ssl; # managed by Certbot
      listen [::]:10441 ssl;
      ssl_certificate /etc/letsencrypt/live/CHANGE/fullchain.pem; # managed by Certbot
      ssl_certificate_key /etc/letsencrypt/live/CHANGE/privkey.pem; # managed by Certbot
      include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
      ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
      server_name CHANGE; # managed by Certbot
    
      location / {
          include proxy_params;
          proxy_pass https://127.0.0.1:5000/;
      }
  }
  ```
  ```bash
  sudo systemctl reload nginx
  ```
- –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–µ –∑–∞–±—É–¥—å—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ `src/.env`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–æ–∫–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

- /yandex-calendar checks check_account
  ![checks_account](imgs/checks_account.PNG)

- /yandex-calendar connections connect
  ![connect](imgs/connect.PNG)

- /yandex-calendar connections profile
  ![profile](imgs/profile.PNG)

- /yandex-calendar calendars current [--date]
  ![current](imgs/current.PNG)

- /yandex-calendar connections disconnect
  ![disconnect](imgs/disconnect.PNG)

- /yandex-calendar calendars get_a_month <br>
  –°–Ω–∏–∑—É –±—É–¥—É—Ç –≤—ã—Å–≤–µ—á–∏–≤–∞—Ç—å—Å—è –æ—à–∏–±–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å __–Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–ª—Å—è__,
  –Ω–æ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π –∑–∞ –º–µ—Å—è—Ü.
  ![error](imgs/error.PNG)

- /yandex-calendar calendars from_to
  ![from_to](imgs/from_to.PNG)

- /yandex-calendar calendars get_a_month <br>
  –í –º–æ–¥—É–ª–µ `calendars` —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞—Ö –±—É–¥–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–π —Ñ–æ—Ä–º–µ
  ![get_a_month](imgs/get_a_month.PNG)

- /yandex-calendar info
  ![info](imgs/info.PNG)

- /yandex-calendar notifications create/update <br>
  –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫. –° –ø–æ–º–æ—â—å—é `update` –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫,
  –∑–∞–¥–∞—Ç—å –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  ![notifications_create](imgs/notifications_create.PNG)

  –û—Ç–≤–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–º –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–µ
  ![notification_created](imgs/notifications_created.PNG)

- /yandex-calendar notifications delete <br>
  –ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
  ![notifications_delete](imgs/notifications_delete.PNG)

- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏)/(–µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –æ–±–æ –≤—Å–µ—Ö —Å–µ–≥–æ–¥–Ω—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è—Ö)
  ![notify](imgs/upcoming_conference.PNG)

## –ê–ª–≥–æ—Ä–∏—Ç–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

1. –í –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–ª–µ–¥—É–µ—Ç –ø—Ä–æ–ø–∏—Å–∞—Ç—å –≤ —Å—Ç–∏–ª–µ cron —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
   –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, –∫ —è–Ω–¥–µ–∫—Å-—Å–µ—Ä–≤–µ—Ä—É<br>
   –ü—Ä–∏–º–µ—Ä—ã https://crontab.guru/examples.html

2. –í–Ω–∏–º–∞–Ω–∏–µ! –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–ª–µ–¥—É–µ—Ç —Ç–æ–Ω–∫–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä–µ–º—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ø–∏–Ω–≥–∞ —Å–µ—Ä–≤–µ—Ä–∞.
   –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã —Å–ª–∏—à–∫–æ–º —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ, —Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –∏–∑–ª–∏—à–Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω–æ, –µ—Å–ª–∏ –∂–µ —Ä–µ–¥–∫–∏–µ, —Ç–æ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å
   –æ—á–µ–Ω—å —á–∞—Å—Ç—ã–º–∏ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è–º–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –±—É–¥–µ—Ç –Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–∞.

3. –í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É–¥–∞–ª—ë–Ω–Ω—ã—Ö/–∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö/–¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π –Ω–∞ —è–Ω–¥–µ–∫—Å-—Å–µ—Ä–≤–µ—Ä–µ.

4. –ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–ª–µ–¥—É–µ—Ç –ø–æ–º–µ–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∞ –∏–º–µ–Ω–Ω–æ:
    1. –ø–æ–º–µ–Ω—è—Ç—å –≤ –∫–æ–¥–µ —Ñ—É–Ω–∫—Ü–∏—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞ 1 –º–∏–Ω—É—Ç—É(–ø–æ–º–µ–Ω—è—Ç—å 10 –Ω–∞ 1)
    2. –ø–æ–º–µ–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ `–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ—Ç 15 –º–∏–Ω—É—Ç –∏ –±–æ–ª–µ–µ` –Ω–∞ `–≤ –ø–µ—Ä–µ–¥–µ–ª–∞—Ö –æ—Ç
       –≤—Ä–µ–º–µ–Ω–∏ —Å–µ–π—á–∞—Å –∏ –±–æ–ª–µ–µ`.
    3. –ø–æ–º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á –Ω–∞ –ø–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞ —è–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å cron —Å—Ç–∏–ª–∏—Å—Ç–∏–∫–∏ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–µ–∫—É–Ω–¥—ã,
       –Ω–∞–ø—Ä–∏–º–µ—Ä –ø–∏–Ω–≥ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥, –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —ç—Ç–æ–≥–æ –Ω–µ —Å—Ç–æ–∏—Ç –¥–µ–ª–∞—Ç—å. –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏.
       `jitter ` - –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –≤ —Å–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–µ–º—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ —Å–µ–∫—É–Ω–¥
       https://apscheduler.readthedocs.io/en/latest/modules/triggers/cron.html#module-apscheduler.triggers.cron .
       –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–∏–ª—å–Ω—ã—Ö –Ω–∞–≥—Ä—É–∑–∫–∞—Ö –≤ —á–∞—Å –ø–∏–∫.

5. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:
    1. –û—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –≤—Å–µ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∏ –ø—Ä–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–∏ –Ω–∞–¥ –Ω–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    2. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –≤–∞—Å –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –Ω–∞—á–∞–ª –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è –±—ã–ª–∞
       –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–µ —Ä–∞–Ω—å—à–µ 15 –º–∏–Ω—É—Ç. –ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö –∫–æ—Ç–æ—Ä—ã–µ
       –Ω–µ
       –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ —Å–æ–æ–±—â–µ–Ω–∏—è. 5 –º–∏–Ω—É—Ç –±—É—Ñ–µ—Ä.
    3. –°–º–µ–Ω–∞ —Å—Ç–∞—Ç—É—Å –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ –º–æ–º–µ–Ω—Ç –Ω–∞—á–∞–ª–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∏ –∑–∞–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –≤ –º–æ–º–µ–Ω—Ç –æ–∫–æ–Ω—á–∞–Ω–∏—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏. –ï—Å–ª–∏,
       –≤–∞—à —Å—Ç–∞—Ç—É—Å –¥–ª–∏—Ç–µ–ª—å–Ω–µ–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∏–ª–∏ —Å—Ç–æ–∏—Ç –≤ —Ä–µ–∂–∏–º–µ(–ø–æ—Å—Ç–æ—è–Ω–Ω–æ), —Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–µ—Ä–Ω—É—Ç –≤–∞—à
       —Å—Ç–∞—Ç—É—Å.
    4. –ë–ª–æ–∫ `notifications` —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –ø–æ–¥–ø—É–Ω–∫—Ç–æ–≤:
        - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –≤—Ä–µ–º—è
        - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–±–æ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –≤–∞—à–∏–º–∏ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è–º–∏, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ –ª–æ–Ω–≥-–ø—É–ª–ª–∏–Ω–≥,
          –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –Ω–∞—á–∞–ª–∞ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
    5. –ü—Ä–∏–º–µ—Ä—ã:
        - –¥–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è ![was_added](imgs/was_added.PNG)
        - –∏–∑–º–µ–Ω–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è ![was_updated](imgs/was_updated.PNG)
        - —É–¥–∞–ª—ë–Ω–Ω–∞—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è ![was_deleted](imgs/was_deleted.PNG)

6. –ü—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–∏–µ
    - –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤–≤–æ–¥–∏—Ç–µ –≤–∞–ª–∏–¥–Ω—ã–π –ª–æ–≥–∏–Ω, —Ç–æ–∫–µ–Ω, –ø–æ—Ç–æ–º –ø–æ–ª—å–∑—É–µ—Ç–µ—Å—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –∑–∞—Ç–µ–º –º–µ–Ω—è–µ—Ç–µ
      –≤ —è–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –ª–æ–≥–∏–Ω –∏–ª–∏ —Ç–æ–∫–µ–Ω,
      —Ç–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å—Ä–∞–∑—É —É–¥–∞–ª—è–µ—Ç –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–∞–∫ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –°–ª–µ–¥—É–µ—Ç –ª–∏–±–æ –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è—Ç—å,
      –ª–∏–±–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —É–¥–∞–ª—è—Ç—å/–æ–±–Ω–æ–≤–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    - –ï—Å–ª–∏ –≤—ã –≤—ã–±–∏—Ä–∞–µ—Ç–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–∏, –∞ –ø–æ—Ç–æ–º —É–¥–∞–ª—è–µ—Ç–µ –≤ —è–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ, –≤–∞—à –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
      —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è–º–∏ —É–¥–∞–ª—è–µ—Ç—Å—è –∫–∞–∫ –Ω–µ –≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ–ø—è—Ç—å –∂–µ - –æ–±–Ω–æ–≤–ª—è–π—Ç–µ/—É–¥–∞–ª—è—Ç–µ –≤–∞—à–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
      —á–µ—Ä–µ–∑
      –∫–æ–º–∞–Ω–¥—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    - –ö–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ä–∞–Ω—å—à–µ 15 –º–∏–Ω—É—Ç –Ω–µ –±—É–¥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∏
      —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–º —Å–æ–±—ã—Ç–∏–∏, —Ç–∞–∫ –∫–∞–∫ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–≤–µ–¥–æ–º–∏—Ç—å –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–µ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –∑–∞ 10 –º–∏–Ω—É—Ç –µ—Å–ª–∏ –≤—ã
      —Å–æ–∑–¥–∞–ª–∏
      –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—é –∑–∞ 1, 3, 5 –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ –¥–æ 15 –º–∏–Ω—É—Ç. 5 –º–∏–Ω—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –±—É—Ñ–µ—Ä.
    - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ apscheduler –Ω–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, –ø–æ—ç—Ç–æ–º—É –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö gunicorn –Ω–µ —Å–ª–µ–¥—É–µ—Ç 
      –∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ–ª–µ–µ 1 –ø—Ä–æ—Ü–µ—Å—Å–∞. –°—É—â–µ—Å—Ç–≤—É—é—Ç –æ–±—Ö–æ–¥–Ω—ã–µ –ø—É—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –≤ apscheduler.
        
      > #### https://apscheduler.readthedocs.io/en/latest/faq.html#how-do-i-share-a-single-job-store-among-one-or-more-worker-processes
      > APScheduler does not currently have any interprocess synchronization and signalling scheme that would enable 
      > the scheduler to be notified when a job has been added, modified or removed from a job store.
      > 
      > Workaround: Run the scheduler in a dedicated process and connect to it via some sort of remote access mechanism 
      > like RPyC, gRPC or an HTTP server. The source repository contains an example of a 
      > RPyC based service that is accessed by a client.

## –î–∏–∞–≥—Ä–∞–º–º—ã

- __–ü–∏–Ω–≥ —Å–µ—Ä–≤–µ—Ä–∞__ <br>![diagram](imgs/diagram.svg)
- __–ë–î__ <br>![DB](imgs/db_schema.PNG)
- __apscheduler_job__ <br>![tb1](imgs/tb_apscheduler_job.PNG)
- __user_account__ <br>![tb2](imgs/tb_user_account.PNG)
- __yandex_calendar__ <br>![tb3](imgs/tb_yandex_calendar.PNG)
- yandex_conference <br>![tb4](imgs/tb_yandex_conference.PNG)

## –ü—Ä–æ–±—É–µ–º –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

* –ü–æ–≤—ã—Å–∏–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–¥–∞ —Å–¥–µ–ª–∞–≤ –µ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º(asyncio, Quart).
* –î–æ–±–∞–≤–∏–ª–∏ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π rabbitmq —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –∏ –Ω–∞–¥—ë–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è. (–†–∞–Ω—å—à–µ –ø—Ä–æ—Å—Ç–æ –ë–î)
* –í–Ω–µ–¥—Ä–∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á Dramatiq(–î–ª—è –Ω–∞—à–∏—Ö –∑–∞–¥–∞—á —Å–∞–º–æ–µ —Ç–æ)
* –ï—Å—Ç—å –∏–¥–µ—è —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π –∏ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π –≤ Redis —Ç–∞–∫ –∫–∞–∫ –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–π,
–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–≤—Å–µ–º –∫–ª—é—á—å-–∑–Ω–∞—á–Ω–∏–µ(–ø–æ–∫–∞ –¥—É–º–∞–µ–º)
* –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ –∏ mock —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
* –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å middleware Prometheus –≤ dramatiq(–≤ 2 –≤–µ—Ä—Å–∏–∏ –∞–≤—Ç–æ—Ä —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —É–±—Ä–∞—Ç—å –∏–∑ –∫–æ—Ä–æ–±–∫–∏)

1. rabbitmq
    –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ .env
    ```bash
    sudo docker compose up -d
    ```
2. worker dramatiq
    ```bash
    dramatiq app.notifications.tasks
    ```
3. events scheduler
    ```bash
    python -m app.notifications.task0_scheduler
    ```
4. web server
   ```bash
   bash run-server.bash
   ```
5. –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
6. –ó–∞–ø—É—Å–∫–∞–µ–º –¥–æ–∫–µ—Ä —Ñ–∞–π–ª
   ```bash
   cd src/microsevice/ && sudo docker compose up -d
   ```
   C–º–æ—Ç—Ä–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
   ```bash
   sudo docker stats 
   ```
   –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
   ```bash
   sudo docker compose logs > output.txt
   ```
7. –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î 
   - https://alembic.sqlalchemy.org/en/latest/tutorial.html
   - https://alembic.sqlalchemy.org/en/latest/autogenerate.html
   - https://github.com/sqlalchemy/alembic/issues/805
   - –≤ `/src`
     ```bash
     alembic init -t async alembic
     ```
   - –≤ —Ñ–∞–π–ª–µ `alembic.ini` –º–µ–Ω—è–µ–º url –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π<br>
     sqlalchemy.url = ~~driver://user:pass@localhost/dbname~~
   - –≤ —Ñ–∞–π–ª–µ `env.py` –º–µ–Ω—è–µ–º target_metadata
     ```text
     from app.sql_app.models import metadata_obj
     target_metadata = metadata_obj
     # target_metadata = None
     ```
   - –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –¥–µ–ª–∞–µ–º –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–∫—Ä–∏–ø—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
     ```bash
     alembic revision --autogenerate -m "Added account table"
     ```
   - –∑–∞–ø—É—Å–∫–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é
     ```bash
     alembic upgrade head
     ```
   - –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
     ```bash
     alembic history --verbose
     ```

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- Scheduling All Kinds of Recurring Jobs with Python - https://martinheinz.dev/blog/39
- 7 —Å–ø–æ—Å–æ–±–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π —Å –ø–æ–º–æ—â—å—é Python - https://evogeek.ru/articles/250819/
- –†–∞–±–æ—Ç–∞ —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –Ω–∞ Flask - https://kirill-sklyarenko.ru/lenta/flask-api-json-web-token-1
- –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –∫–ª—é—á–µ–π -
  https://stackoverflow.com/questions/2490334/simple-way-to-encode-a-string-according-to-a-password
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤ –∏ –ø–æ—Ç–æ–∫–æ–≤ –≤ gunicorn - https://stackoverflow.com/questions/38425620/gunicorn-workers-and-threads
- Mattermost Yandex Calendar Plugin (CALDav) - https://github.com/LugaMuga/mattermost-yandex-calendar-plugin
- –ö–æ–º–∞–Ω–¥—ã Postgresql - https://www.postgresqltutorial.com/postgresql-administration/psql-commands/
- –ö–æ–º–∞–Ω–¥—ã SQL - https://www.w3schools.com/sql/default.asp
- Mattermost troubleshooting - https://docs.mattermost.com/install/troubleshooting.html
- Installing
  packages - https://packaging.python.org/en/latest/guides/installing-using-pip-and-virtual-environments/#creating-a-virtual-environment
- RFC2445(iCalendar) - https://www.ietf.org/rfc/rfc2445.txt
- RFC4791(CALDAV) - https://www.ietf.org/rfc/rfc4791.txt
- Python iCalendar - https://github.com/collective/icalendar
- Python CalDAV - https://github.com/python-caldav/caldav
- Add column psql with foreign
  key - https://stackoverflow.com/questions/17645609/add-new-column-with-foreign-key-constraint-in-one-command
- What is a reasonable code coverage % for unit tests (and
  why)? - https://stackoverflow.com/questions/90002/what-is-a-reasonable-code-coverage-for-unit-tests-and-why
- sync/thread/async https://ru.stackoverflow.com/questions/1159101/python-thread-multiprocessing-asyncio
- rebbitmq docker-compose https://habr.com/ru/companies/slurm/articles/704208/
- periodic task https://docs.celeryq.dev/en/latest/userguide/periodic-tasks.html#using-custom-scheduler-classes
- prefork vs eventlet https://stackoverflow.com/questions/29952907/celery-eventlet-pool-does-not-improve-execution-speed-of-asynchronous-web-requ
- Asynchronous yield from https://peps.python.org/pep-0525/#asynchronous-yield-from
- SQLAlchemy Transactions https://docs.sqlalchemy.org/en/20/core/connections.html#begin-once 
- Flower --broker_api https://github.com/mher/flower/issues/1036
- rabbitmq (unacked,ready) https://stackoverflow.com/questions/31915773/rabbitmq-what-are-ready-and-unacked-types-of-messages
- rabbitmq docker environs https://www.rabbitmq.com/configure.html#supported-environment-variables
- asyncpg interface error https://stackoverflow.com/questions/66444620/asyncpg-cannot-perform-operation-another-operation-is-in-progress
- best naming endpoints in restful https://blog.dreamfactory.com/best-practices-for-naming-rest-api-endpoints/
- pgadmin https://www.pgadmin.org/docs/pgadmin4/latest/container_deployment.html
- Recurrence events in CalDAV https://icalendar.org/iCalendar-RFC-5545/3-8-4-4-recurrence-id.html
- cancel asyncio.to_thread Task https://stackoverflow.com/questions/71416383/python-asyncio-cancelling-a-to-thread-task-wont-stop-the-thread
- asyncpg transaction error https://stackoverflow.com/questions/74313692/fastapi-asyncpg-sqlalchemy-cannot-use-connection-transaction-in-a-manual

## –í–æ–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç

- –ü–æ—á–µ–º—É –Ω–µ —à–∏—Ñ—Ä—É–µ—à—å —Ç–æ–∫–µ–Ω—ã?

    + –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —à–∏—Ñ—Ä–æ–≤–∞–ª —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ cryptography —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç Fernet.
      –í –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—ã—è—Å–Ω–∏–ª, —á—Ç–æ –Ω–∏ Redmine, –Ω–∏ Mattermost –Ω–µ —à–∏—Ñ—Ä—É—é—Ç —Ç–æ–∫–µ–Ω—ã. –•–æ—Ç—è –ø–∞—Ä–æ–ª–∏ —Ö—ç—à–∏—Ä—É—é—Ç - —ç—Ç–æ –º—ã
      –æ–¥–æ–±—Ä—è–µ–º.
      –í –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –±–æ–ª—å—à–∞—è –ø–æ–ª–µ–º–∏–∫–∞ –ø–æ —Ç–æ–º—É, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –ª–∏—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –Ø —Å–∫–ª–æ–Ω–∏–ª—Å—è –∫ —Ç–æ–º—É, —á—Ç–æ
      –Ω—É–∂–Ω–æ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –ø–æ–ª–∏—Ç–∏–∫–∞ —Å–∞–º–æ–≥–æ —Å–∞–π—Ç–∞, –≥–¥–µ —Ä—è–¥–æ–º —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è. –ï—Å–ª–∏ —à–∏—Ñ—Ä—É—é—Ç, —Ç–æ –Ω—É–∂–Ω–æ —Ç–æ–∂–µ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å
      –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.

    + –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –≤ –∫–∞–∫ —Ç–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –Ω–∞—à–µ–π –ë–î.
        * –≤—ã –¥–æ–ª–∂–Ω—ã —É–∂–µ –±—ã–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –º–∞—Ç—Ç–µ—Ä–º–æ—Å—Ç(–¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–Ω, —Ç–æ–∫–µ–Ω, —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å).
        ```bash
        sudo docker exec -it microservice-db-1 bash
        ```
      –í—ã –ø–µ—Ä–µ—à–ª–∏ –≤ –æ–±–æ–ª–æ—á–∫—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ë–î, —Å–º–æ—Ç—Ä–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ë–î
        ```bash
        su postgres
        ```
        ```bash
        psql
        ```
        ```bash
        \dt
        ```
                        List of relations
           Schema |       Name        | Type  |  Owner   
          --------+-------------------+-------+----------
           public | user_account      | table | postgres
           public | yandex_calendar   | table | postgres
           public | yandex_conference | table | postgres
          (3 rows)

        ```bash
        SELECT id, token FROM user_account;
        ```

           id |      token         
          ----+----------------------------
            1 | hak3jkeh67y4dd1h6q8r16gqrr 
          (1 row)

    + –¢–æ–∫–µ–Ω —É –Ω–∞—Å –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω(–º—ã –Ω–∏—á–µ–≥–æ –∏ –Ω–µ –¥–µ–ª–∞–ª–∏ –¥–ª—è —ç—Ç–æ–≥–æ), –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Ç–æ–¥ –¥–æ–ª–≥–∏–π, –ª—É—á—à–µ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –≤
      –¥–æ–∫–µ—Ä –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–∞—Ç—Ç–µ—Ä–º–æ—Å—Ç–∞ adminer –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –≤–µ–±–µ.
      ![mm](imgs/mm.PNG)

    + –í –º–∞—Ç—Ç–µ—Ä–º–æ—Å—Ç —Ç–æ–∂–µ –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω, —Ç–∞–∫–∞—è –∂–µ —Å–∏—Ç—É–∞—Ü–∏—è –∏ –≤ —Ä–µ–¥–º–∞–π–Ω–µ.

    + –ü–æ—á–µ–º—É –Ω–µ —à–∏—Ñ—Ä—É–µ–º? –ï—Å–ª–∏, –±—É–∫–≤–∞–ª—å–Ω–æ –≤ –¥–≤—É—Ö —Å–ª–æ–≤–∞—Ö, —Ç–æ REST API —Ç–æ–∫–µ–Ω—ã –ø–æ–∑–≤–æ–ª—è–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤—Å–µ–º –º–∞–ª—É—é —á–∞—Å—Ç—å
      —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –ü–∞—Ä–æ–ª–∏ –∑–∞—Ö–µ—à–∏—Ä–æ–≤–∞–Ω—ã, —É–∂–µ —Ö–æ—Ä–æ—à–æ. –ï—Å–ª–∏ —É–Ω–µ—Å—É—Ç –ë–î –≤—Å–µ —Ç–æ–∫–µ–Ω—ã –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –∂–µ –ø–æ–º–µ–Ω—è—Ç—å.

    + https://docs.mattermost.com/developer/personal-access-tokens.html

- –ß—Ç–æ –º—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º?

    + –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏ - —Ä–∞–∑–¥–µ–ª—ã
        1. */calendars*
        2. */checks*
        3. */connections*
        4. */notifications*
        5. */jobs*
    
## –ü—Ä–æ–±–ª–µ–º—ã –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è

- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–∞–∫–æ–π-–ª–∏–±–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, RESTAPI, —Ç—É—Ç–æ—Ä–∏–∞–ª–∞, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏—è –æ—Ç —è–Ω–¥–µ–∫—Å–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ø–Ω–¥–µ–∫—Å-–ö–∞–ª–µ–Ω–¥–∞—Ä—ë–º –≤
  —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ JSON, XML. Google —Ö–æ—Ä–æ—à–æ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª —Ä–∞–±–æ—Ç—É —Å google –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º –Ω–∞ python
  https://developers.google.com/calendar/api/quickstart/python?hl=ru
- –í—ã–±–æ—Ä–∫–∞ —Ç–µ–∫—É—â–∏—Ö –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ —á–∞—Å–æ–≤–æ–º—É –ø–æ—è—Å—É –∫–ª–∏–µ–Ω—Ç–∞, –µ—Å–ª–∏ –≤—ã –ø–æ–º–µ–Ω—è–ª–∏ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å, —Ç–æ —Å—Ç–∞—Ä—ã–µ
  –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏ –Ω–µ –º–µ–Ω—è—é—Ç —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å, —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–∞–π—Ç–µ –≤–∏–∑—É–∞–ª—å–Ω–æ. –ü–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏
  —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –º–∞—Ç—Ç–µ—Ä–º–æ—Å—Ç.
- –ù–µ –¥–æ—Å—Ç—É–ø–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç—å (—Ç–µ–≥ freebusy, —Å—Ç–∞—Ç—É—Å 504).
- –ï—Å–ª–∏ –≤ —è–Ω–¥–µ–∫—Å-–∫–∞–ª–µ–Ω–¥–∞—Ä–µ —Å–æ–∑–¥–∞—é –∫–∞–ª–µ–Ω–¥–∞—Ä–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–º–µ–Ω–µ–º, —Ç–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ —Ñ–æ—Ä–º—É, –º–∞—Ç—Ç–µ—Ä–º–æ—Å—Ç —É–¥–∞–ª—è–µ—Ç —ç—Ç–∏
  –¥—É–±–ª–∏–∫–∞—Ç—ã.
  –≠—Ç–æ –∏ –ª–æ–≥–∏—á–Ω–æ, –∫–∞–∫ –Ω–∞–º –∏—Ö –æ—Ç–ª–∏—á–∏—Ç—å, –µ—Å–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∏–º–µ–Ω–∞. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä –ø–æ id, –Ω–æ —ç—Ç–æ –Ω–µ —Å–∞–º—ã–µ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π
  –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –±–µ–∑ —É—á–∞—Å—Ç–∏—è –∫–ª–∏–µ–Ω—Ç–∞, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π.
  –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —Å–µ—Ä–≤–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞ —Å–æ–±—ã—Ç–∏–π –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –∞—Ç—Ä–∏–±—É—Ç–∞–º –≤—ã—Ç—è–≥–∏–≤–∞–µ–º–æ–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏. –î–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π
  —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∞—Å—å –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π-–∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π –ø–æ sync_token —Å
  —Å–æ–±—ã—Ç–∏—è–º–∏-–∫–æ–Ω—Ñ—Ä–µ–Ω–µ—Ü–∏—è–º–∏
  –≤ –ë–î.
- –ù–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Å–æ–±—ã—Ç–∏–∏. –ó–¥–µ—Å—å –∏–º–µ–µ—Ç—Å—è –≤–≤–∏–¥—É, —á—Ç–æ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ `calendar.search`
  –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –Ω–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –ª–∏—à–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è. –Ø —Å–æ–∑–¥–∞–ª issue –¥–ª—è –∞–≤—Ç–æ—Ä–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `caldav` 
  https://github.com/python-caldav/caldav/issues/351 . –¢—É—Ç –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ, —Ç–æ –ª–∏ —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—è(–Ω–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
  —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç timezone) —Ç–æ –ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `caldav`

## –ë—É–¥—É—â–∏–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏

- –¥–æ–±–∞–≤–∏—Ç—å —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫
- –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–π —á–µ—Ä–µ–∑ CalDAV —Å–µ—Ä–≤–µ—Ä
- –ø–æ–∫—Ä—ã—Ç—å –∫–æ–¥ —Ç–µ—Å—Ç–∞–º–∏
- –≤—ã—è–≤–∏—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- –∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∞

## –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- –ü—Ä–æ–µ–∫—Ç—É https://github.com/lugamuga/mattermost-yandex-calendar-plugin,
  –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å —è–Ω–¥–µ–∫—Å –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º, –µ—Å—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
  https://pkg.go.dev/github.com/lugamuga/mattermost-yandex-calendar-plugin
- –ü—Ä–æ–µ–∫—Ç—É https://github.com/python-caldav/caldav , –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≤—Å—è —Ç—è–∂–µ–ª–µ–π—à–∞—è —Ä–∞–±–æ—Ç–∞
  –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –ø–∞–∫–µ—Ç–∞. –û—Ç–ª–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, –Ω–æ –µ—Å—Ç—å –µ—â—ë –Ω–∞–¥ —á–µ–º –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å(—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º). –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è -
  https://caldav.readthedocs.io/en/latest/
- –ü—Ä–æ–µ–∫—Ç—É https://github.com/agronholm/apscheduler . –û—Ç–ª–∏—á–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á,
  —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∏ –ë–î. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - https://pypi.org/project/APScheduler/
- –ü—Ä–æ–µ–∫—Ç—É [mattermostautodriver](https://github.com/embl-bio-it/python-mattermost-autodriver), —Ñ–æ—Ä–∫ –æ—Ç –∑–∞–±—Ä–æ—à–µ–Ω–Ω–æ–≥–æ
  –ø—Ä–æ–µ–∫—Ç–∞ [mattermostdriver](https://github.com/Vaelor/python-mattermost-driver) . –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è,
  —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º [Mattermost API Reference (4.0.0)](https://api.mattermost.com/).
  –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è https://embl-bio-it.github.io/python-mattermost-autodriver/ . –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—å
  –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏
  Mattermost API –≤ –ø–∞–∫–µ—Ç–µ
  –¥—Ä–∞–π–≤–µ—Ä–∞ https://github.com/embl-bio-it/python-mattermost-autodriver#updating-openapi-specification
  –î—Ä–∞–π–≤–µ—Ä –Ω–µ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ Mattermost, –æ–¥–Ω–∞–∫–æ –∏–º–µ–µ—Ç –≤—Å–µ —à–∞–Ω—Å—ã –±—ã—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º. –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–∞–ª—å–Ω–µ–π—à–∞—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞
- –í–∞—Å–∏–ª–∏—é, –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
- –ê–Ω–∞—Å—Ç–∞—Å–∏–∏, –ø–æ–º–æ—â—å –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
